# DevBox Environment Configuration
# Copy this file to .env and customize for your environment

# =============================================================================
# CONTAINER CONFIGURATION
# =============================================================================

# Container and image naming
IMAGE_NAME=ghcr.io/jclement/devbox:latest
CONTAINER_NAME=devbox

# Restart policy: no, always, on-failure, unless-stopped
RESTART_POLICY=unless-stopped

# =============================================================================
# USER CONFIGURATION
# =============================================================================
# These should match your host user to avoid permission issues

# On macOS/Linux, run: id -u
USER_UID=1000

# On macOS/Linux, run: id -g
USER_GID=1000

# Your username
USERNAME=devbox

# Optional: Set a password for HTTP Basic Auth on all web services
# When set, all web access (code-server, pgweb, mailhog, file browser, status page, and your app)
# will require authentication with username (from USERNAME) and this password.
# SSH remains key-based only regardless of this setting.
# Leave empty for unrestricted web access (recommended for private Tailnets or local development)
PASSWORD=

# =============================================================================
# NETWORKING MODE
# =============================================================================
# Choose between Tailscale (remote access) or Local (port forwarding)

# --- Tailscale Mode (Remote Access) ---
# Generate auth key at: https://login.tailscale.com/admin/settings/keys
# Leave empty to use Local mode instead
TS_AUTHKEY=

# Short hostname for Tailscale - defaults to CONTAINER_NAME if not set
# Only set this if you want a different Tailscale hostname than your container name
# TS_HOSTNAME=my-custom-hostname

# Tailscale domain suffix (e.g., "your-tailnet.ts.net" or "ts.net")
# Full hostname will be: {TS_HOSTNAME}.{TS_SUFFIX}
# Used for TLS certificates - leave empty if not using Tailscale HTTPS
TS_SUFFIX=

# --- Local Mode (Port Forwarding) ---
# Port mappings for local mode
# Change these to avoid conflicts when running multiple instances
SSH_PORT=2200
CADDY_PORT=8400
POSTGRES_PORT=5400

# Examples for multiple instances on same host:
#   Instance 1: SSH_PORT=2200, CADDY_PORT=8400, POSTGRES_PORT=5400
#   Instance 2: SSH_PORT=2210, CADDY_PORT=8410, POSTGRES_PORT=5410
#   Instance 3: SSH_PORT=2220, CADDY_PORT=8420, POSTGRES_PORT=5420

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=devdb

# =============================================================================
# SERVICE CONFIGURATION
# =============================================================================

# Port where your development service runs inside the container
# This is where Caddy will proxy requests to for the root path
DEV_SERVICE_PORT=3000

# Code-Server (VS Code in browser) Configuration
# Semicolon-delimited list of VS Code extensions to install on first run
# Leave empty to skip extension installation
VSCODE_DEFAULT_EXTENSIONS=vscodevim.vim;ReprEng.csv;Anthropic.claude-code;bierner.markdown-mermaid;tamasfe.even-better-toml;github.copilot;github.copilot-chat

# Default VS Code color theme
VSCODE_DEFAULT_THEME=Default Dark+

# =============================================================================
# SNAPSHOTS CONFIGURATION
# =============================================================================

# This is the location where snapshots created with snapshot are stored.

# SNAPSHOTS_DIR=./data/snapshots

# =============================================================================
# SSH CONFIGURATION
# =============================================================================

# The SSH_DIR directory is bind mounted to ~/.ssh inside the container
# Place your SSH keys and authorized_keys file in ./ssh/
# 
# Defaults to ~/.ssh
#
# Required files:
#   ./ssh/authorized_keys - SSH public keys that can access this container
#
# Optional files:
#   ./ssh/id_ed25519     - Private key for git operations (recommended)
#   ./ssh/id_ed25519.pub - Public key for git commit signing
#   ./ssh/id_rsa         - Alternative private key
#   ./ssh/config         - SSH client configuration
#
# Note: If id_ed25519.pub exists, it will be used for git commit signing
SSH_DIR=

# =============================================================================
# OPTIONAL LIFECYCLE HOOKS
# =============================================================================

# Hook scripts (defaults to stubs in /opt/hooks/)
# Override via environment variables or bind mount custom scripts
# Examples:
#   PRE_START_HOOK=/opt/hooks/pre_start.sh
#   POST_START_HOOK=/opt/hooks/post_start.sh
#   PRE_RESTORE_HOOK=/opt/hooks/pre_restore.sh
#   POST_RESTORE_HOOK=/opt/hooks/post_restore.sh
#   INITIAL_SCHEMA=/opt/hooks/initial_schema.sql

# =============================================================================
# CLOUDFLARE TUNNEL (Optional)
# =============================================================================

# Cloudflare tunnel token for public access via Cloudflare
# Get token at: https://one.dash.cloudflare.com/
# Leave empty if not using Cloudflare tunnels
CF_TUNNEL_TOKEN=

# =============================================================================
# EXAMPLE CONFIGURATIONS
# =============================================================================

# Example 1: Local development (macOS)
# ------------------------------------
# CONTAINER_NAME=myproject-dev
# USER_UID=501
# USER_GID=20
# USERNAME=myuser
# SSH_PORT=2200
# CADDY_PORT=8400
# POSTGRES_PORT=5400
# TS_AUTHKEY=
# DEV_SERVICE_PORT=3000

# Example 2: Remote development with Tailscale
# --------------------------------------------
# CONTAINER_NAME=dev-myproject
# USER_UID=1000
# USER_GID=1000
# USERNAME=myuser
# TS_AUTHKEY=tskey-auth-xxxxxxxxxxxxxxxxxxxxx
# TS_SUFFIX=your-tailnet.ts.net
# # TS_HOSTNAME will default to "dev-myproject" (from CONTAINER_NAME)
# DEV_SERVICE_PORT=8080
# DB_SEED_FILE="database/seed.sql"

# Example 3: Multiple instances on same host
# ------------------------------------------
# CONTAINER_NAME=project-frontend
# SSH_PORT=2200
# CADDY_PORT=8400
# POSTGRES_PORT=5400
# # Another instance would use:
# # CONTAINER_NAME=project-backend
# # SSH_PORT=2210
# # CADDY_PORT=8410
# # POSTGRES_PORT=5410
